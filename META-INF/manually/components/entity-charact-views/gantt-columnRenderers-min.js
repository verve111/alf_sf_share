!function(){beCPG.module.GanttViewRendererHelper&&YAHOO.Bubbling.fire("registerGanttRenderer",{typeName:"pjt:taskList",ganttInitialiser:function(t){var e=Alfresco.constants.PROXY_URI+"becpg/project/info"+(null!=this.options.siteId&&this.options.siteId.length>0?"?site="+this.options.siteId:"");Alfresco.util.Ajax.request({url:e,successCallback:{fn:function(e){var a=e.json.legends,s="";for(var i in a){var l={id:a[i].nodeRef,label:a[i].label,color:a[i].color.replace("#","")};this.taskLegends.push(l),s+='<div style="white-space: nowrap;display:inline-block;margin-right:5px;"><span class="task-legend" style="background-color:#'+l.color+'" ></span><span>'+l.label+"</span>&nbsp;</div>"}Dom.get(this.id+"-legend").innerHTML=s;var n=function(){var t=this.widgets.dataTable.getRecordSet();if(0!=t.getLength()){g=new JSGantt.GanttChart("g",Dom.get(this.id+"-gantt"),null!=g?g.getFormat():null),g.setDateInputFormat("mediumDate"),g.setDateDisplayFormat("mediumDate"),g.setCaptionType("Resource");for(var e=new Date,a=0;a<t.getLength();a++){var s=t.getRecord(a),i=s.getData(),l=i.nodeRef,n="",r=0;null!=i.itemData.prop_bcpg_parentLevel.value&&(r=i.itemData.prop_bcpg_parentLevel.value);var o=i.itemData.prop_pjt_tlIsGroup.value?1:0;for(var p in i.itemData.assoc_pjt_tlPrevTasks){var c=i.itemData.assoc_pjt_tlPrevTasks[p].value;n.length>0&&(n+=","),n+=c,null!=this.cache[c]&&null!=this.cache[c].end&&this.cache[c].end.getTime()>e.getTime()&&(e=this.cache[c].end)}var h=i.itemData.prop_pjt_tlIsMilestone.value,d=i.itemData.prop_pjt_completionPercent.value,u=i.itemData.assoc_pjt_tlResources.length>0?'<span class="resource-title">'+i.itemData.assoc_pjt_tlResources[0].displayValue+"</span>":null,m=this.cache[l];m||(m=this.extractDates(i,e,!0),this.cache[l]=m),g.AddTaskItem(new JSGantt.TaskItem(l,this.getTaskTitle(i,this.options.entityNodeRef,m.start),m.start,m.end,this.getTaskColor(i),null,h?1:0,u,d,o,r,1,n,null,i.color))}this.refreshView()}else Alfresco.util.populateHTML([this.id+"-gantt",'<div class="yui-dt-liner">'+this.msg("message.empty")+"</div>"])};this.extraAfterDataGridUpdate.push(n),this.initTaskHandlers(),t.call(this)},scope:this}})}})}();